[2022-08-08 16:25:58] PRINT get params
[2022-08-08 16:25:58] PRINT {'batch_size': 512, 'epochs': 2, 'seq': 15, 'path': './data/kdd17/ourpped/'}
[2022-08-08 16:25:58] PRINT 51  tickers selected
[2022-08-08 16:25:58] PRINT ['SNP500.csv', 'BA.csv', 'TM.csv', 'MO.csv', 'NVS.csv', 'T.csv', 'DCM.csv', 'CHL.csv', 'BAC.csv', 'PEP.csv', 'VALE.csv', 'D.csv', 'MRK.csv', 'ORCL.csv', 'PG.csv', 'AMZN.csv', 'INTC.csv', 'MMM.csv', 'KO.csv', 'UPS.csv', 'MSFT.csv', 'TOT.csv', 'EXC.csv', 'HD.csv', 'SO.csv', 'XOM.csv', 'CVX.csv', 'RDS-B.csv', 'CMCSA.csv', 'NGG.csv', 'BHP.csv', 'WFC.csv', 'DIS.csv', 'GE.csv', 'PTR.csv', 'JPM.csv', 'SPY.csv', 'GOOGL.csv', 'PFE.csv', 'DUK.csv', 'VZ.csv', 'UNH.csv', 'MA.csv', 'SYT.csv', 'AAPL.csv', 'WMT.csv', 'NTT.csv', 'RIO.csv', 'BRK-B.csv', 'DOW.csv', 'JNJ.csv']
[2022-08-08 16:25:59] PRINT 2518 trading dates
[2022-08-08 16:25:59] PRINT tra, val, tes index:  0 2014 2266
[2022-08-08 16:25:59] PRINT 1970  training instances
[2022-08-08 16:25:59] PRINT 252  validaing instances
[2022-08-08 16:25:59] PRINT 252  testing instances
[2022-08-08 16:26:00] PRINT KerasTensor(type_spec=TensorSpec(shape=(None, 51, 15, 11), dtype=tf.float32, name='index_input'), name='index_input', description="created by layer 'index_input'")
[2022-08-08 16:26:00] PRINT dtml
[2022-08-08 16:26:01] PRINT attention shape (None, 11)
[2022-08-08 16:26:01] PRINT backend_reshape shape (None, 51, 11)
[2022-08-08 16:26:01] PRINT layer shape (None, 50, 11)
[2022-08-08 16:26:01] PRINT final shape (None, 50, 1)
[2022-08-08 16:26:02] PRINT Epoch 1/2
[2022-08-08 16:26:05] PRINT  1/62 [..............................] - ETA: 2:53 - loss: 0.7428 - accuracy: 0.4800
[2022-08-08 16:26:05] PRINT  3/62 [>.............................] - ETA: 2s - loss: 0.7366 - accuracy: 0.4948  
[2022-08-08 16:26:05] PRINT  5/62 [=>............................] - ETA: 2s - loss: 0.7341 - accuracy: 0.4984
[2022-08-08 16:26:05] PRINT  7/62 [==>...........................] - ETA: 2s - loss: 0.7286 - accuracy: 0.5067
[2022-08-08 16:26:05] PRINT  9/62 [===>..........................] - ETA: 2s - loss: 0.7272 - accuracy: 0.5067
[2022-08-08 16:26:05] PRINT 11/62 [====>.........................] - ETA: 2s - loss: 0.7209 - accuracy: 0.5169
[2022-08-08 16:26:05] PRINT 13/62 [=====>........................] - ETA: 2s - loss: 0.7143 - accuracy: 0.5288
[2022-08-08 16:26:05] PRINT 15/62 [======>.......................] - ETA: 2s - loss: 0.7113 - accuracy: 0.5340
[2022-08-08 16:26:06] PRINT 17/62 [=======>......................] - ETA: 2s - loss: 0.7071 - accuracy: 0.5415
[2022-08-08 16:26:06] PRINT 19/62 [========>.....................] - ETA: 2s - loss: 0.7020 - accuracy: 0.5503
[2022-08-08 16:26:06] PRINT 20/62 [========>.....................] - ETA: 2s - loss: 0.6990 - accuracy: 0.5552
[2022-08-08 16:26:06] PRINT 22/62 [=========>....................] - ETA: 1s - loss: 0.6936 - accuracy: 0.5637
[2022-08-08 16:26:06] PRINT 24/62 [==========>...................] - ETA: 1s - loss: 0.6915 - accuracy: 0.5680
[2022-08-08 16:26:06] PRINT 26/62 [===========>..................] - ETA: 1s - loss: 0.6889 - accuracy: 0.5732
[2022-08-08 16:26:06] PRINT 28/62 [============>.................] - ETA: 1s - loss: 0.6863 - accuracy: 0.5784
[2022-08-08 16:26:06] PRINT 30/62 [=============>................] - ETA: 1s - loss: 0.6845 - accuracy: 0.5827
[2022-08-08 16:26:06] PRINT 31/62 [==============>...............] - ETA: 1s - loss: 0.6829 - accuracy: 0.5855
[2022-08-08 16:26:06] PRINT 33/62 [==============>...............] - ETA: 1s - loss: 0.6808 - accuracy: 0.5898
[2022-08-08 16:26:06] PRINT 35/62 [===============>..............] - ETA: 1s - loss: 0.6782 - accuracy: 0.5942
[2022-08-08 16:26:07] PRINT 37/62 [================>.............] - ETA: 1s - loss: 0.6774 - accuracy: 0.5967
[2022-08-08 16:26:07] PRINT 39/62 [=================>............] - ETA: 1s - loss: 0.6769 - accuracy: 0.5990
[2022-08-08 16:26:07] PRINT 41/62 [==================>...........] - ETA: 1s - loss: 0.6760 - accuracy: 0.6016
[2022-08-08 16:26:07] PRINT 43/62 [===================>..........] - ETA: 0s - loss: 0.6747 - accuracy: 0.6046
[2022-08-08 16:26:07] PRINT 45/62 [====================>.........] - ETA: 0s - loss: 0.6740 - accuracy: 0.6067
[2022-08-08 16:26:07] PRINT 47/62 [=====================>........] - ETA: 0s - loss: 0.6737 - accuracy: 0.6076
[2022-08-08 16:26:07] PRINT 49/62 [======================>.......] - ETA: 0s - loss: 0.6739 - accuracy: 0.6078
[2022-08-08 16:26:07] PRINT 50/62 [=======================>......] - ETA: 0s - loss: 0.6734 - accuracy: 0.6085
[2022-08-08 16:26:07] PRINT 51/62 [=======================>......] - ETA: 0s - loss: 0.6730 - accuracy: 0.6091
[2022-08-08 16:26:07] PRINT 52/62 [========================>.....] - ETA: 0s - loss: 0.6724 - accuracy: 0.6099
[2022-08-08 16:26:07] PRINT 53/62 [========================>.....] - ETA: 0s - loss: 0.6716 - accuracy: 0.6110
[2022-08-08 16:26:07] PRINT 55/62 [=========================>....] - ETA: 0s - loss: 0.6707 - accuracy: 0.6124
[2022-08-08 16:26:08] PRINT 57/62 [==========================>...] - ETA: 0s - loss: 0.6692 - accuracy: 0.6146
[2022-08-08 16:26:08] PRINT 58/62 [===========================>..] - ETA: 0s - loss: 0.6689 - accuracy: 0.6151
[2022-08-08 16:26:08] PRINT 59/62 [===========================>..] - ETA: 0s - loss: 0.6683 - accuracy: 0.6161
[2022-08-08 16:26:08] PRINT 61/62 [============================>.] - ETA: 0s - loss: 0.6675 - accuracy: 0.6172
[2022-08-08 16:26:09] PRINT 62/62 [==============================] - 7s 62ms/step - loss: 0.6674 - accuracy: 0.6175 - val_loss: 0.6194 - val_accuracy: 0.6867
[2022-08-08 16:26:09] PRINT Epoch 2/2
[2022-08-08 16:26:09] PRINT  1/62 [..............................] - ETA: 3s - loss: 0.6231 - accuracy: 0.6788
[2022-08-08 16:26:09] PRINT  3/62 [>.............................] - ETA: 2s - loss: 0.6416 - accuracy: 0.6692
[2022-08-08 16:26:09] PRINT  5/62 [=>............................] - ETA: 2s - loss: 0.6390 - accuracy: 0.6702
[2022-08-08 16:26:09] PRINT  6/62 [=>............................] - ETA: 2s - loss: 0.6377 - accuracy: 0.6709
[2022-08-08 16:26:09] PRINT  7/62 [==>...........................] - ETA: 2s - loss: 0.6318 - accuracy: 0.6787
[2022-08-08 16:26:09] PRINT  8/62 [==>...........................] - ETA: 2s - loss: 0.6270 - accuracy: 0.6825
[2022-08-08 16:26:09] PRINT  9/62 [===>..........................] - ETA: 2s - loss: 0.6383 - accuracy: 0.6688
[2022-08-08 16:26:09] PRINT 11/62 [====>.........................] - ETA: 2s - loss: 0.6352 - accuracy: 0.6740
[2022-08-08 16:26:09] PRINT 13/62 [=====>........................] - ETA: 2s - loss: 0.6418 - accuracy: 0.6646
[2022-08-08 16:26:09] PRINT 15/62 [======>.......................] - ETA: 2s - loss: 0.6427 - accuracy: 0.6635
[2022-08-08 16:26:09] PRINT 17/62 [=======>......................] - ETA: 2s - loss: 0.6417 - accuracy: 0.6645
[2022-08-08 16:26:09] PRINT 18/62 [=======>......................] - ETA: 2s - loss: 0.6430 - accuracy: 0.6627
[2022-08-08 16:26:10] PRINT 20/62 [========>.....................] - ETA: 1s - loss: 0.6430 - accuracy: 0.6626
[2022-08-08 16:26:10] PRINT 22/62 [=========>....................] - ETA: 1s - loss: 0.6410 - accuracy: 0.6652
[2022-08-08 16:26:10] PRINT 24/62 [==========>...................] - ETA: 1s - loss: 0.6429 - accuracy: 0.6619
[2022-08-08 16:26:10] PRINT 25/62 [===========>..................] - ETA: 1s - loss: 0.6426 - accuracy: 0.6619
[2022-08-08 16:26:10] PRINT 27/62 [============>.................] - ETA: 1s - loss: 0.6402 - accuracy: 0.6654
[2022-08-08 16:26:10] PRINT 28/62 [============>.................] - ETA: 1s - loss: 0.6426 - accuracy: 0.6622
[2022-08-08 16:26:10] PRINT 29/62 [=============>................] - ETA: 1s - loss: 0.6441 - accuracy: 0.6610
[2022-08-08 16:26:10] PRINT 31/62 [==============>...............] - ETA: 1s - loss: 0.6438 - accuracy: 0.6609
[2022-08-08 16:26:10] PRINT 32/62 [==============>...............] - ETA: 1s - loss: 0.6451 - accuracy: 0.6585
[2022-08-08 16:26:10] PRINT 34/62 [===============>..............] - ETA: 1s - loss: 0.6441 - accuracy: 0.6601
[2022-08-08 16:26:10] PRINT 35/62 [===============>..............] - ETA: 1s - loss: 0.6421 - accuracy: 0.6624
[2022-08-08 16:26:10] PRINT 37/62 [================>.............] - ETA: 1s - loss: 0.6405 - accuracy: 0.6643
[2022-08-08 16:26:11] PRINT 39/62 [=================>............] - ETA: 1s - loss: 0.6402 - accuracy: 0.6644
[2022-08-08 16:26:11] PRINT 41/62 [==================>...........] - ETA: 1s - loss: 0.6398 - accuracy: 0.6651
[2022-08-08 16:26:11] PRINT 42/62 [===================>..........] - ETA: 0s - loss: 0.6404 - accuracy: 0.6647
[2022-08-08 16:26:11] PRINT 44/62 [====================>.........] - ETA: 0s - loss: 0.6402 - accuracy: 0.6650
[2022-08-08 16:26:11] PRINT 46/62 [=====================>........] - ETA: 0s - loss: 0.6399 - accuracy: 0.6652
[2022-08-08 16:26:11] PRINT 47/62 [=====================>........] - ETA: 0s - loss: 0.6406 - accuracy: 0.6645
[2022-08-08 16:26:11] PRINT 48/62 [======================>.......] - ETA: 0s - loss: 0.6421 - accuracy: 0.6624
[2022-08-08 16:26:11] PRINT 50/62 [=======================>......] - ETA: 0s - loss: 0.6418 - accuracy: 0.6630
[2022-08-08 16:26:11] PRINT 52/62 [========================>.....] - ETA: 0s - loss: 0.6422 - accuracy: 0.6622
[2022-08-08 16:26:11] PRINT 54/62 [=========================>....] - ETA: 0s - loss: 0.6427 - accuracy: 0.6605
[2022-08-08 16:26:11] PRINT 56/62 [==========================>...] - ETA: 0s - loss: 0.6435 - accuracy: 0.6595
[2022-08-08 16:26:11] PRINT 58/62 [===========================>..] - ETA: 0s - loss: 0.6433 - accuracy: 0.6595
[2022-08-08 16:26:12] PRINT 60/62 [============================>.] - ETA: 0s - loss: 0.6442 - accuracy: 0.6579
[2022-08-08 16:26:12] PRINT 62/62 [==============================] - ETA: 0s - loss: 0.6445 - accuracy: 0.6569
[2022-08-08 16:26:12] PRINT 62/62 [==============================] - 3s 51ms/step - loss: 0.6445 - accuracy: 0.6569 - val_loss: 0.6212 - val_accuracy: 0.6863
[2022-08-08 16:26:12] PRINT Final result is: %d 0.6891270279884338
