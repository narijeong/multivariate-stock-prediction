[2022-08-09 14:55:42] PRINT get params
[2022-08-09 14:55:42] PRINT {'batch_size': 256, 'epochs': 2, 'seq': 15, 'path': './data/kdd17/ourpped/'}
[2022-08-09 14:55:42] PRINT 51  tickers selected
[2022-08-09 14:55:42] PRINT ['SNP500.csv', 'BA.csv', 'TM.csv', 'MO.csv', 'NVS.csv', 'T.csv', 'DCM.csv', 'CHL.csv', 'BAC.csv', 'PEP.csv', 'VALE.csv', 'D.csv', 'MRK.csv', 'ORCL.csv', 'PG.csv', 'AMZN.csv', 'INTC.csv', 'MMM.csv', 'KO.csv', 'UPS.csv', 'MSFT.csv', 'TOT.csv', 'EXC.csv', 'HD.csv', 'SO.csv', 'XOM.csv', 'CVX.csv', 'RDS-B.csv', 'CMCSA.csv', 'NGG.csv', 'BHP.csv', 'WFC.csv', 'DIS.csv', 'GE.csv', 'PTR.csv', 'JPM.csv', 'SPY.csv', 'GOOGL.csv', 'PFE.csv', 'DUK.csv', 'VZ.csv', 'UNH.csv', 'MA.csv', 'SYT.csv', 'AAPL.csv', 'WMT.csv', 'NTT.csv', 'RIO.csv', 'BRK-B.csv', 'DOW.csv', 'JNJ.csv']
[2022-08-09 14:55:42] PRINT 2518 trading dates
[2022-08-09 14:55:42] PRINT tra, val, tes index:  0 2014 2266
[2022-08-09 14:55:42] PRINT 1970  training instances
[2022-08-09 14:55:42] PRINT 252  validaing instances
[2022-08-09 14:55:42] PRINT 252  testing instances
[2022-08-09 14:55:43] PRINT KerasTensor(type_spec=TensorSpec(shape=(None, 51, 15, 11), dtype=tf.float32, name='index_input'), name='index_input', description="created by layer 'index_input'")
[2022-08-09 14:55:43] PRINT dtml
[2022-08-09 14:55:44] PRINT attention shape (None, 11)
[2022-08-09 14:55:44] PRINT backend_reshape shape (None, 51, 11)
[2022-08-09 14:55:44] PRINT layer shape (None, 50, 11)
[2022-08-09 14:55:44] PRINT final shape (None, 50, 1)
[2022-08-09 14:55:44] PRINT Epoch 1/2
[2022-08-09 14:55:47] PRINT  1/62 [..............................] - ETA: 2:35 - loss: 0.8996 - accuracy: 0.3144
[2022-08-09 14:55:47] PRINT  2/62 [..............................] - ETA: 3s - loss: 0.8485 - accuracy: 0.3691  
[2022-08-09 14:55:47] PRINT  4/62 [>.............................] - ETA: 3s - loss: 0.8258 - accuracy: 0.3816
[2022-08-09 14:55:47] PRINT  6/62 [=>............................] - ETA: 2s - loss: 0.7995 - accuracy: 0.4138
[2022-08-09 14:55:47] PRINT  8/62 [==>...........................] - ETA: 2s - loss: 0.7793 - accuracy: 0.4382
[2022-08-09 14:55:47] PRINT 10/62 [===>..........................] - ETA: 2s - loss: 0.7637 - accuracy: 0.4604
[2022-08-09 14:55:48] PRINT 12/62 [====>.........................] - ETA: 2s - loss: 0.7463 - accuracy: 0.4855
[2022-08-09 14:55:48] PRINT 14/62 [=====>........................] - ETA: 2s - loss: 0.7361 - accuracy: 0.5020
[2022-08-09 14:55:48] PRINT 16/62 [======>.......................] - ETA: 2s - loss: 0.7294 - accuracy: 0.5135
[2022-08-09 14:55:48] PRINT 18/62 [=======>......................] - ETA: 2s - loss: 0.7218 - accuracy: 0.5267
[2022-08-09 14:55:48] PRINT 19/62 [========>.....................] - ETA: 2s - loss: 0.7180 - accuracy: 0.5337
[2022-08-09 14:55:48] PRINT 20/62 [========>.....................] - ETA: 2s - loss: 0.7139 - accuracy: 0.5402
[2022-08-09 14:55:48] PRINT 21/62 [=========>....................] - ETA: 2s - loss: 0.7106 - accuracy: 0.5459
[2022-08-09 14:55:48] PRINT 22/62 [=========>....................] - ETA: 2s - loss: 0.7076 - accuracy: 0.5514
[2022-08-09 14:55:48] PRINT 23/62 [==========>...................] - ETA: 2s - loss: 0.7041 - accuracy: 0.5568
[2022-08-09 14:55:48] PRINT 24/62 [==========>...................] - ETA: 2s - loss: 0.7013 - accuracy: 0.5612
[2022-08-09 14:55:48] PRINT 26/62 [===========>..................] - ETA: 1s - loss: 0.6969 - accuracy: 0.5693
[2022-08-09 14:55:48] PRINT 28/62 [============>.................] - ETA: 1s - loss: 0.6952 - accuracy: 0.5742
[2022-08-09 14:55:48] PRINT 29/62 [=============>................] - ETA: 1s - loss: 0.6963 - accuracy: 0.5743
[2022-08-09 14:55:49] PRINT 31/62 [==============>...............] - ETA: 1s - loss: 0.6971 - accuracy: 0.5760
[2022-08-09 14:55:49] PRINT 33/62 [==============>...............] - ETA: 1s - loss: 0.6966 - accuracy: 0.5793
[2022-08-09 14:55:49] PRINT 35/62 [===============>..............] - ETA: 1s - loss: 0.6952 - accuracy: 0.5825
[2022-08-09 14:55:49] PRINT 36/62 [================>.............] - ETA: 1s - loss: 0.6953 - accuracy: 0.5832
[2022-08-09 14:55:49] PRINT 37/62 [================>.............] - ETA: 1s - loss: 0.6951 - accuracy: 0.5840
[2022-08-09 14:55:49] PRINT 38/62 [=================>............] - ETA: 1s - loss: 0.6939 - accuracy: 0.5861
[2022-08-09 14:55:49] PRINT 39/62 [=================>............] - ETA: 1s - loss: 0.6924 - accuracy: 0.5882
[2022-08-09 14:55:49] PRINT 40/62 [==================>...........] - ETA: 1s - loss: 0.6921 - accuracy: 0.5887
[2022-08-09 14:55:49] PRINT 41/62 [==================>...........] - ETA: 1s - loss: 0.6906 - accuracy: 0.5907
[2022-08-09 14:55:49] PRINT 42/62 [===================>..........] - ETA: 1s - loss: 0.6908 - accuracy: 0.5906
[2022-08-09 14:55:49] PRINT 43/62 [===================>..........] - ETA: 1s - loss: 0.6904 - accuracy: 0.5914
[2022-08-09 14:55:49] PRINT 44/62 [====================>.........] - ETA: 0s - loss: 0.6889 - accuracy: 0.5937
[2022-08-09 14:55:49] PRINT 45/62 [====================>.........] - ETA: 0s - loss: 0.6880 - accuracy: 0.5949
[2022-08-09 14:55:49] PRINT 46/62 [=====================>........] - ETA: 0s - loss: 0.6879 - accuracy: 0.5952
[2022-08-09 14:55:49] PRINT 47/62 [=====================>........] - ETA: 0s - loss: 0.6881 - accuracy: 0.5951
[2022-08-09 14:55:50] PRINT 49/62 [======================>.......] - ETA: 0s - loss: 0.6885 - accuracy: 0.5947
[2022-08-09 14:55:50] PRINT 51/62 [=======================>......] - ETA: 0s - loss: 0.6873 - accuracy: 0.5964
[2022-08-09 14:55:50] PRINT 53/62 [========================>.....] - ETA: 0s - loss: 0.6866 - accuracy: 0.5974
[2022-08-09 14:55:50] PRINT 55/62 [=========================>....] - ETA: 0s - loss: 0.6856 - accuracy: 0.5985
[2022-08-09 14:55:50] PRINT 57/62 [==========================>...] - ETA: 0s - loss: 0.6844 - accuracy: 0.6001
[2022-08-09 14:55:50] PRINT 59/62 [===========================>..] - ETA: 0s - loss: 0.6834 - accuracy: 0.6016
[2022-08-09 14:55:50] PRINT 61/62 [============================>.] - ETA: 0s - loss: 0.6820 - accuracy: 0.6036
[2022-08-09 14:55:51] PRINT 62/62 [==============================] - 7s 65ms/step - loss: 0.6814 - accuracy: 0.6044 - val_loss: 0.6307 - val_accuracy: 0.6800
[2022-08-09 14:55:51] PRINT Epoch 2/2
[2022-08-09 14:55:51] PRINT  1/62 [..............................] - ETA: 2s - loss: 0.6919 - accuracy: 0.5956
[2022-08-09 14:55:51] PRINT  3/62 [>.............................] - ETA: 2s - loss: 0.6748 - accuracy: 0.6240
[2022-08-09 14:55:51] PRINT  4/62 [>.............................] - ETA: 2s - loss: 0.6546 - accuracy: 0.6480
[2022-08-09 14:55:51] PRINT  6/62 [=>............................] - ETA: 2s - loss: 0.6521 - accuracy: 0.6494
[2022-08-09 14:55:51] PRINT  8/62 [==>...........................] - ETA: 2s - loss: 0.6549 - accuracy: 0.6432
[2022-08-09 14:55:51] PRINT 10/62 [===>..........................] - ETA: 2s - loss: 0.6505 - accuracy: 0.6498
[2022-08-09 14:55:52] PRINT 12/62 [====>.........................] - ETA: 2s - loss: 0.6493 - accuracy: 0.6526
[2022-08-09 14:55:52] PRINT 14/62 [=====>........................] - ETA: 2s - loss: 0.6466 - accuracy: 0.6559
[2022-08-09 14:55:52] PRINT 16/62 [======>.......................] - ETA: 1s - loss: 0.6451 - accuracy: 0.6575
[2022-08-09 14:55:52] PRINT 18/62 [=======>......................] - ETA: 1s - loss: 0.6503 - accuracy: 0.6526
[2022-08-09 14:55:52] PRINT 20/62 [========>.....................] - ETA: 1s - loss: 0.6550 - accuracy: 0.6475
[2022-08-09 14:55:52] PRINT 22/62 [=========>....................] - ETA: 1s - loss: 0.6542 - accuracy: 0.6489
[2022-08-09 14:55:52] PRINT 24/62 [==========>...................] - ETA: 1s - loss: 0.6571 - accuracy: 0.6452
[2022-08-09 14:55:52] PRINT 26/62 [===========>..................] - ETA: 1s - loss: 0.6575 - accuracy: 0.6442
[2022-08-09 14:55:52] PRINT 28/62 [============>.................] - ETA: 1s - loss: 0.6567 - accuracy: 0.6449
[2022-08-09 14:55:52] PRINT 30/62 [=============>................] - ETA: 1s - loss: 0.6567 - accuracy: 0.6443
[2022-08-09 14:55:52] PRINT 32/62 [==============>...............] - ETA: 1s - loss: 0.6581 - accuracy: 0.6419
[2022-08-09 14:55:52] PRINT 34/62 [===============>..............] - ETA: 1s - loss: 0.6569 - accuracy: 0.6435
[2022-08-09 14:55:52] PRINT 36/62 [================>.............] - ETA: 0s - loss: 0.6556 - accuracy: 0.6451
[2022-08-09 14:55:52] PRINT 38/62 [=================>............] - ETA: 0s - loss: 0.6547 - accuracy: 0.6456
[2022-08-09 14:55:52] PRINT 40/62 [==================>...........] - ETA: 0s - loss: 0.6543 - accuracy: 0.6456
[2022-08-09 14:55:53] PRINT 42/62 [===================>..........] - ETA: 0s - loss: 0.6532 - accuracy: 0.6467
[2022-08-09 14:55:53] PRINT 44/62 [====================>.........] - ETA: 0s - loss: 0.6529 - accuracy: 0.6474
[2022-08-09 14:55:53] PRINT 46/62 [=====================>........] - ETA: 0s - loss: 0.6528 - accuracy: 0.6477
[2022-08-09 14:55:53] PRINT 48/62 [======================>.......] - ETA: 0s - loss: 0.6529 - accuracy: 0.6475
[2022-08-09 14:55:53] PRINT 50/62 [=======================>......] - ETA: 0s - loss: 0.6534 - accuracy: 0.6473
[2022-08-09 14:55:53] PRINT 52/62 [========================>.....] - ETA: 0s - loss: 0.6530 - accuracy: 0.6478
[2022-08-09 14:55:53] PRINT 54/62 [=========================>....] - ETA: 0s - loss: 0.6529 - accuracy: 0.6481
[2022-08-09 14:55:53] PRINT 56/62 [==========================>...] - ETA: 0s - loss: 0.6515 - accuracy: 0.6499
[2022-08-09 14:55:53] PRINT 58/62 [===========================>..] - ETA: 0s - loss: 0.6506 - accuracy: 0.6511
[2022-08-09 14:55:53] PRINT 60/62 [============================>.] - ETA: 0s - loss: 0.6518 - accuracy: 0.6494
[2022-08-09 14:55:53] PRINT 62/62 [==============================] - ETA: 0s - loss: 0.6521 - accuracy: 0.6491
[2022-08-09 14:55:53] PRINT 62/62 [==============================] - 2s 37ms/step - loss: 0.6521 - accuracy: 0.6491 - val_loss: 0.6226 - val_accuracy: 0.6863
[2022-08-09 14:55:53] PRINT Final result is: %d 0.6896824836730957
