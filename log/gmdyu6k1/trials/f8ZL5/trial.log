[2022-08-09 14:55:13] PRINT get params
[2022-08-09 14:55:13] PRINT {'batch_size': 512, 'epochs': 2, 'seq': 15, 'path': './data/kdd17/ourpped/'}
[2022-08-09 14:55:13] PRINT 51  tickers selected
[2022-08-09 14:55:13] PRINT ['SNP500.csv', 'BA.csv', 'TM.csv', 'MO.csv', 'NVS.csv', 'T.csv', 'DCM.csv', 'CHL.csv', 'BAC.csv', 'PEP.csv', 'VALE.csv', 'D.csv', 'MRK.csv', 'ORCL.csv', 'PG.csv', 'AMZN.csv', 'INTC.csv', 'MMM.csv', 'KO.csv', 'UPS.csv', 'MSFT.csv', 'TOT.csv', 'EXC.csv', 'HD.csv', 'SO.csv', 'XOM.csv', 'CVX.csv', 'RDS-B.csv', 'CMCSA.csv', 'NGG.csv', 'BHP.csv', 'WFC.csv', 'DIS.csv', 'GE.csv', 'PTR.csv', 'JPM.csv', 'SPY.csv', 'GOOGL.csv', 'PFE.csv', 'DUK.csv', 'VZ.csv', 'UNH.csv', 'MA.csv', 'SYT.csv', 'AAPL.csv', 'WMT.csv', 'NTT.csv', 'RIO.csv', 'BRK-B.csv', 'DOW.csv', 'JNJ.csv']
[2022-08-09 14:55:14] PRINT 2518 trading dates
[2022-08-09 14:55:14] PRINT tra, val, tes index:  0 2014 2266
[2022-08-09 14:55:14] PRINT 1970  training instances
[2022-08-09 14:55:14] PRINT 252  validaing instances
[2022-08-09 14:55:14] PRINT 252  testing instances
[2022-08-09 14:55:15] PRINT KerasTensor(type_spec=TensorSpec(shape=(None, 51, 15, 11), dtype=tf.float32, name='index_input'), name='index_input', description="created by layer 'index_input'")
[2022-08-09 14:55:15] PRINT dtml
[2022-08-09 14:55:15] PRINT attention shape (None, 11)
[2022-08-09 14:55:15] PRINT backend_reshape shape (None, 51, 11)
[2022-08-09 14:55:15] PRINT layer shape (None, 50, 11)
[2022-08-09 14:55:15] PRINT final shape (None, 50, 1)
[2022-08-09 14:55:16] PRINT Epoch 1/2
[2022-08-09 14:55:19] PRINT  1/62 [..............................] - ETA: 2:43 - loss: 0.8166 - accuracy: 0.5275
[2022-08-09 14:55:19] PRINT  2/62 [..............................] - ETA: 3s - loss: 0.7913 - accuracy: 0.5391  
[2022-08-09 14:55:19] PRINT  3/62 [>.............................] - ETA: 3s - loss: 0.7878 - accuracy: 0.5392
[2022-08-09 14:55:19] PRINT  4/62 [>.............................] - ETA: 2s - loss: 0.7809 - accuracy: 0.5400
[2022-08-09 14:55:19] PRINT  5/62 [=>............................] - ETA: 2s - loss: 0.7806 - accuracy: 0.5351
[2022-08-09 14:55:19] PRINT  6/62 [=>............................] - ETA: 2s - loss: 0.7740 - accuracy: 0.5405
[2022-08-09 14:55:19] PRINT  7/62 [==>...........................] - ETA: 2s - loss: 0.7692 - accuracy: 0.5440
[2022-08-09 14:55:19] PRINT  8/62 [==>...........................] - ETA: 2s - loss: 0.7603 - accuracy: 0.5482
[2022-08-09 14:55:19] PRINT  9/62 [===>..........................] - ETA: 2s - loss: 0.7534 - accuracy: 0.5527
[2022-08-09 14:55:19] PRINT 11/62 [====>.........................] - ETA: 2s - loss: 0.7470 - accuracy: 0.5541
[2022-08-09 14:55:19] PRINT 12/62 [====>.........................] - ETA: 2s - loss: 0.7417 - accuracy: 0.5582
[2022-08-09 14:55:20] PRINT 13/62 [=====>........................] - ETA: 2s - loss: 0.7367 - accuracy: 0.5616
[2022-08-09 14:55:20] PRINT 15/62 [======>.......................] - ETA: 2s - loss: 0.7274 - accuracy: 0.5704
[2022-08-09 14:55:20] PRINT 16/62 [======>.......................] - ETA: 2s - loss: 0.7263 - accuracy: 0.5709
[2022-08-09 14:55:20] PRINT 17/62 [=======>......................] - ETA: 2s - loss: 0.7244 - accuracy: 0.5725
[2022-08-09 14:55:20] PRINT 19/62 [========>.....................] - ETA: 2s - loss: 0.7157 - accuracy: 0.5823
[2022-08-09 14:55:20] PRINT 20/62 [========>.....................] - ETA: 2s - loss: 0.7138 - accuracy: 0.5843
[2022-08-09 14:55:20] PRINT 21/62 [=========>....................] - ETA: 2s - loss: 0.7084 - accuracy: 0.5906
[2022-08-09 14:55:20] PRINT 22/62 [=========>....................] - ETA: 2s - loss: 0.7063 - accuracy: 0.5928
[2022-08-09 14:55:20] PRINT 23/62 [==========>...................] - ETA: 2s - loss: 0.7031 - accuracy: 0.5965
[2022-08-09 14:55:20] PRINT 24/62 [==========>...................] - ETA: 1s - loss: 0.6988 - accuracy: 0.6011
[2022-08-09 14:55:20] PRINT 25/62 [===========>..................] - ETA: 1s - loss: 0.6954 - accuracy: 0.6055
[2022-08-09 14:55:20] PRINT 26/62 [===========>..................] - ETA: 1s - loss: 0.6927 - accuracy: 0.6087
[2022-08-09 14:55:20] PRINT 27/62 [============>.................] - ETA: 1s - loss: 0.6939 - accuracy: 0.6069
[2022-08-09 14:55:20] PRINT 28/62 [============>.................] - ETA: 1s - loss: 0.6921 - accuracy: 0.6091
[2022-08-09 14:55:20] PRINT 30/62 [=============>................] - ETA: 1s - loss: 0.6892 - accuracy: 0.6126
[2022-08-09 14:55:21] PRINT 32/62 [==============>...............] - ETA: 1s - loss: 0.6884 - accuracy: 0.6134
[2022-08-09 14:55:21] PRINT 33/62 [==============>...............] - ETA: 1s - loss: 0.6857 - accuracy: 0.6167
[2022-08-09 14:55:21] PRINT 35/62 [===============>..............] - ETA: 1s - loss: 0.6837 - accuracy: 0.6183
[2022-08-09 14:55:21] PRINT 36/62 [================>.............] - ETA: 1s - loss: 0.6846 - accuracy: 0.6173
[2022-08-09 14:55:21] PRINT 38/62 [=================>............] - ETA: 1s - loss: 0.6817 - accuracy: 0.6204
[2022-08-09 14:55:21] PRINT 40/62 [==================>...........] - ETA: 1s - loss: 0.6804 - accuracy: 0.6217
[2022-08-09 14:55:21] PRINT 42/62 [===================>..........] - ETA: 1s - loss: 0.6797 - accuracy: 0.6221
[2022-08-09 14:55:21] PRINT 44/62 [====================>.........] - ETA: 0s - loss: 0.6773 - accuracy: 0.6249
[2022-08-09 14:55:21] PRINT 45/62 [====================>.........] - ETA: 0s - loss: 0.6765 - accuracy: 0.6256
[2022-08-09 14:55:21] PRINT 47/62 [=====================>........] - ETA: 0s - loss: 0.6764 - accuracy: 0.6255
[2022-08-09 14:55:21] PRINT 49/62 [======================>.......] - ETA: 0s - loss: 0.6766 - accuracy: 0.6247
[2022-08-09 14:55:21] PRINT 51/62 [=======================>......] - ETA: 0s - loss: 0.6737 - accuracy: 0.6279
[2022-08-09 14:55:22] PRINT 53/62 [========================>.....] - ETA: 0s - loss: 0.6726 - accuracy: 0.6287
[2022-08-09 14:55:22] PRINT 54/62 [=========================>....] - ETA: 0s - loss: 0.6716 - accuracy: 0.6301
[2022-08-09 14:55:22] PRINT 56/62 [==========================>...] - ETA: 0s - loss: 0.6698 - accuracy: 0.6318
[2022-08-09 14:55:22] PRINT 58/62 [===========================>..] - ETA: 0s - loss: 0.6683 - accuracy: 0.6339
[2022-08-09 14:55:22] PRINT 60/62 [============================>.] - ETA: 0s - loss: 0.6657 - accuracy: 0.6366
[2022-08-09 14:55:22] PRINT 62/62 [==============================] - ETA: 0s - loss: 0.6654 - accuracy: 0.6369
[2022-08-09 14:55:23] PRINT 62/62 [==============================] - 6s 62ms/step - loss: 0.6654 - accuracy: 0.6369 - val_loss: 0.6225 - val_accuracy: 0.6867
[2022-08-09 14:55:23] PRINT Epoch 2/2
[2022-08-09 14:55:23] PRINT  1/62 [..............................] - ETA: 2s - loss: 0.6680 - accuracy: 0.6300
[2022-08-09 14:55:23] PRINT  3/62 [>.............................] - ETA: 2s - loss: 0.6396 - accuracy: 0.6721
[2022-08-09 14:55:23] PRINT  4/62 [>.............................] - ETA: 2s - loss: 0.6535 - accuracy: 0.6556
[2022-08-09 14:55:23] PRINT  6/62 [=>............................] - ETA: 2s - loss: 0.6535 - accuracy: 0.6560
[2022-08-09 14:55:23] PRINT  8/62 [==>...........................] - ETA: 2s - loss: 0.6593 - accuracy: 0.6498
[2022-08-09 14:55:23] PRINT 10/62 [===>..........................] - ETA: 2s - loss: 0.6480 - accuracy: 0.6624
[2022-08-09 14:55:23] PRINT 12/62 [====>.........................] - ETA: 2s - loss: 0.6466 - accuracy: 0.6622
[2022-08-09 14:55:23] PRINT 14/62 [=====>........................] - ETA: 1s - loss: 0.6425 - accuracy: 0.6667
[2022-08-09 14:55:23] PRINT 16/62 [======>.......................] - ETA: 1s - loss: 0.6450 - accuracy: 0.6622
[2022-08-09 14:55:23] PRINT 18/62 [=======>......................] - ETA: 1s - loss: 0.6453 - accuracy: 0.6604
[2022-08-09 14:55:24] PRINT 20/62 [========>.....................] - ETA: 1s - loss: 0.6455 - accuracy: 0.6590
[2022-08-09 14:55:24] PRINT 22/62 [=========>....................] - ETA: 1s - loss: 0.6451 - accuracy: 0.6593
[2022-08-09 14:55:24] PRINT 24/62 [==========>...................] - ETA: 1s - loss: 0.6455 - accuracy: 0.6579
[2022-08-09 14:55:24] PRINT 26/62 [===========>..................] - ETA: 1s - loss: 0.6472 - accuracy: 0.6551
[2022-08-09 14:55:24] PRINT 28/62 [============>.................] - ETA: 1s - loss: 0.6482 - accuracy: 0.6533
[2022-08-09 14:55:24] PRINT 30/62 [=============>................] - ETA: 1s - loss: 0.6460 - accuracy: 0.6560
[2022-08-09 14:55:24] PRINT 32/62 [==============>...............] - ETA: 1s - loss: 0.6462 - accuracy: 0.6546
[2022-08-09 14:55:24] PRINT 34/62 [===============>..............] - ETA: 1s - loss: 0.6474 - accuracy: 0.6535
[2022-08-09 14:55:24] PRINT 36/62 [================>.............] - ETA: 0s - loss: 0.6459 - accuracy: 0.6551
[2022-08-09 14:55:24] PRINT 38/62 [=================>............] - ETA: 0s - loss: 0.6468 - accuracy: 0.6543
[2022-08-09 14:55:24] PRINT 40/62 [==================>...........] - ETA: 0s - loss: 0.6461 - accuracy: 0.6553
[2022-08-09 14:55:24] PRINT 42/62 [===================>..........] - ETA: 0s - loss: 0.6454 - accuracy: 0.6563
[2022-08-09 14:55:24] PRINT 44/62 [====================>.........] - ETA: 0s - loss: 0.6448 - accuracy: 0.6568
[2022-08-09 14:55:24] PRINT 46/62 [=====================>........] - ETA: 0s - loss: 0.6459 - accuracy: 0.6556
[2022-08-09 14:55:24] PRINT 48/62 [======================>.......] - ETA: 0s - loss: 0.6462 - accuracy: 0.6544
[2022-08-09 14:55:24] PRINT 50/62 [=======================>......] - ETA: 0s - loss: 0.6466 - accuracy: 0.6540
[2022-08-09 14:55:24] PRINT 51/62 [=======================>......] - ETA: 0s - loss: 0.6471 - accuracy: 0.6532
[2022-08-09 14:55:25] PRINT 53/62 [========================>.....] - ETA: 0s - loss: 0.6474 - accuracy: 0.6531
[2022-08-09 14:55:25] PRINT 55/62 [=========================>....] - ETA: 0s - loss: 0.6473 - accuracy: 0.6532
[2022-08-09 14:55:25] PRINT 57/62 [==========================>...] - ETA: 0s - loss: 0.6463 - accuracy: 0.6544
[2022-08-09 14:55:25] PRINT 59/62 [===========================>..] - ETA: 0s - loss: 0.6466 - accuracy: 0.6535
[2022-08-09 14:55:25] PRINT 61/62 [============================>.] - ETA: 0s - loss: 0.6463 - accuracy: 0.6537
[2022-08-09 14:55:25] PRINT 62/62 [==============================] - 2s 36ms/step - loss: 0.6459 - accuracy: 0.6544 - val_loss: 0.6200 - val_accuracy: 0.6862
[2022-08-09 14:55:25] PRINT Final result is: %d 0.6894444227218628
